DECLARE @NOLOAN VARCHAR(MAX) = '5318570011224070', @TARGET VARCHAR(MAX)
SET @TARGET = RIGHT(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(@NOLOAN, 'PD', ''), 'LD', ''), 'BN', ''), 'BR', ''), ' ', ''), '	', ''), 12)
SELECT TOP 10
	NOLOAN
	,NOMORCIF
	,KODEOUTLET
	,DIVISI
	,'ONBS'
	,'LOCKED'
FROM [dbo].[PORTOFOLIO.ONBS.LOAN_DETAIL]
WHERE NOLOAN LIKE CONCAT('%', @TARGET, '%')
OR NOMORCIF LIKE CONCAT('%', @TARGET, '%')

UNION

SELECT TOP 10
	NOLOAN
	,CIF
	,[Kode Outlet BSI]
	,[Divisi]
	,'WO'
	,'LOCKED'
FROM [NEW_BSI_COLLECTION].[dbo].[PORTOFOLIO_WO.GENERATED.JOIN.WO_CURRENT]
WHERE NOLOAN LIKE CONCAT('%', @TARGET, '%')
OR CIF LIKE CONCAT('%', @TARGET, '%')
OR [Loan ON Legacy Terakhir] LIKE CONCAT('%', @TARGET, '%')
OR [Loan ON BS iBSM] LIKE CONCAT('%', @TARGET, '%')
OR [Loan WO Legacy] LIKE CONCAT('%', @TARGET, '%')

UNION

SELECT TOP 10
	NOLOAN_BARU
	,NOCIF_BARU
	,KODECABANG_BARU
	,NULL
	,FLAG_DATA
	,'LOCKED'
FROM [NEW_BSI_COLLECTION].[dbo].[PORTOFOLIO_ONBS.COMPILE.JOIN.REKAP_NOLOAN.MUTASI_NOLOAN]
WHERE NOLOAN_LAMA LIKE CONCAT('%', @TARGET, '%')
OR NOCIF_LAMA LIKE CONCAT('%', @TARGET, '%')

UNION
SELECT
	@NOLOAN
	,NULL
	,NULL
	,NULL
	,NULL
	,CASE
		WHEN LEN(CONCAT('LD', @TARGET)) = 12 THEN 'LOAN NOT FOUND'
		WHEN LEN(@NOLOAN) = 16 THEN 'LOAN NOT FOUND'
		ELSE 'INVALID FORMAT'
	END
